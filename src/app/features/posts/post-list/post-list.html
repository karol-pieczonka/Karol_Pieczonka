<div class="container mx-auto my-5 md:py-10 px-5">
  <h2 class="text-5xl font-bold text-center">Posts</h2>
  <p class="text-gray-700 pt-5 pb-10 text-center">The best posts in the world!</p>

  <div class="flex flex-col sm:flex-row gap-4 mb-8 items-center">
    <input
      type="text"
      placeholder="Filter posts by title or content..."
      class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-violet-500"
      [value]="filter()"
      (input)="onFilterInput($event)"
    />
    <select
      class="w-full sm:w-64 p-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-violet-500"
      (change)="onUserChange($event)"
    >
      <option value="">All Users</option>
      @for (user of users(); track user.id) {
        <option [value]="user.id">{{ user.name }}</option>
      }
    </select>
    <div class="flex items-center gap-2 self-end sm:self-center pb-3 sm:pb-0">
      <input
        type="checkbox"
        id="favorites-filter"
        class="h-5 w-5 rounded border-gray-300 text-violet-600 focus:ring-violet-500"
        (change)="onFavoritesFilterChange($event)"
      />
      <label for="favorites-filter" class="text-gray-700 whitespace-nowrap">Only Favorites</label>
    </div>
  </div>

  @if (store.loading()) {
    <app-loader />
  } @else if (store.error()) {
    <p class="text-red-500 text-lg text-center">{{ store.error() }}</p>
  } @else {
    <div class="grid sm:grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-3">
      @for (post of filteredPosts(); track post.id; let i = $index) {
        <app-post-item
          [post]="post"
          [style.--i]="i"
          animate.enter="fade-in"
        />
      }
    </div>
    @if (filteredPosts().length === 0) {
      <p class="text-center text-gray-500 mt-8">No posts found matching your criteria.</p>
    }
  }
</div>
